#!/usr/bin/env node

/*eslint-disable*/
require( "babel-register" );
var fs = require( 'fs' );
var app = require( '../app' );
var https = require( "https" );


if ( app.locals.ENV_DEVELOPMENT ) {
  app.set( 'port', process.env.PORT || 3000 );
  var server = app.listen( app.get( 'port' ), function () {
    console.log( 'Express server listening on port ' + server.address().port );
  } );
} else {
  var privateKey = fs.readFileSync( '/root/ssl/server.key', 'utf8' );
  var certificate = fs.readFileSync( '/root/ssl/bangle_io.crt', 'utf8' );
  var cabundle = fs.readFileSync( '/root/ssl/betterBundle.ca-bundle', 'utf8');
  var credentials = {
    key: privateKey,
    cert: certificate,
    ca: cabundle
    // pfx: cabundle
  };

  app.set( 'port', 443 );
  var server = https.createServer( credentials, app ).listen( app.get( 'port' ), function () {
    console.log( 'Express https listening on port ' + server.address().port );
  } );
}
